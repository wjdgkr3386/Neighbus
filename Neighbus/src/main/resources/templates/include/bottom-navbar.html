<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">

<div th:fragment="bottom-nav">
    <nav class="nb-bottom-nav">
        <ul class="nb-bottom-nav__items">
            <!-- 홈 -->
            <li class="nb-bottom-nav__item">
                <a href="/" class="nb-bottom-nav__link" data-path="/">
                    <i class="bi bi-house-door-fill"></i>
                    <span class="nb-bottom-nav__label">홈</span>
                </a>
            </li>

            <!-- 동아리 -->
            <li class="nb-bottom-nav__item">
                <a href="/club" class="nb-bottom-nav__link" data-path="/club">
                    <i class="bi bi-people-fill"></i>
                    <span class="nb-bottom-nav__label">동아리</span>
                </a>
            </li>

            <!-- 갤러리 -->
            <li class="nb-bottom-nav__item">
                <a href="/gallery" class="nb-bottom-nav__link" data-path="/gallery">
                    <i class="bi bi-images"></i>
                    <span class="nb-bottom-nav__label">갤러리</span>
                </a>
            </li>

            <!-- 게시판 -->
            <li class="nb-bottom-nav__item">
                <a href="/freeboard" class="nb-bottom-nav__link" data-path="/freeboard">
                    <i class="bi bi-chat-dots-fill"></i>
                    <span class="nb-bottom-nav__label">게시판</span>
                </a>
            </li>

            <!-- 채팅 (로그인한 사용자) -->
            <li class="nb-bottom-nav__item" sec:authorize="isAuthenticated()">
                <a href="/chat/room" class="nb-bottom-nav__link" data-path="/chat">
                    <i class="bi bi-chat-left-text-fill"></i>
                    <span class="nb-bottom-nav__label">채팅</span>
                </a>
            </li>
            
            <!-- 마이페이지 (로그인한 사용자) -->
            <li class="nb-bottom-nav__item" sec:authorize="isAuthenticated()">
                <a href="/mypage" class="nb-bottom-nav__link" data-path="/mypage">
                    <i class="bi bi-person-fill"></i>
                    <span class="nb-bottom-nav__label">마이페이지</span>
                </a>
            </li>

            <!-- 소개 (로그아웃한 사용자) -->
            <li class="nb-bottom-nav__item" sec:authorize="!isAuthenticated()">
                <a href="/about" class="nb-bottom-nav__link" data-path="/about">
                    <i class="bi bi-info-circle-fill"></i>
                    <span class="nb-bottom-nav__label">소개</span>
                </a>
            </li>

            <!-- 로그인 (로그아웃한 사용자) -->
            <li class="nb-bottom-nav__item" sec:authorize="!isAuthenticated()">
                 <a href="/account/login" class="nb-bottom-nav__link" data-path="/account">
                    <i class="bi bi-person-circle"></i>
                    <span class="nb-bottom-nav__label">로그인</span>
                </a>
            </li>
        </ul>
    </nav>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Set active menu item
            const currentPath = window.location.pathname;
            const links = document.querySelectorAll('.nb-bottom-nav__link[data-path]');
            
            links.forEach(link => {
                const path = link.getAttribute('data-path');
                // 정확한 경로 일치 또는 하위 경로 일치 확인
                if (path === '/' && currentPath === '/') {
                    link.classList.add('active');
                } else if (path !== '/' && currentPath.startsWith(path)) {
                    link.classList.add('active');
                }
            });
        });
    </script>
</div>
</html>