<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>회원가입 - 동네친구</title>
    <link href="https://fonts.googleapis.com/css2?family=Pretendard:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <script src="auth.js"></script>
    <style>
        :root {
            --primary-color: #7C3AED;
            --primary-color-light: #A78BFA;
            --accent-color: #F97316;
            --background-color: #F8FAFC;
            --text-primary: #1E293B;
            --text-secondary: #64748B;
            --border-color: #E2E8F0;
            --card-bg: #FFFFFF;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, system-ui, sans-serif;
            color: #1E293B;
            min-height: 100vh;
            background: #FFFFFF;
            overflow-x: hidden;	
        }

        .signup-container {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 60px 20px;
            min-height: 100vh;
        }

        .signup-form-wrapper {
            width: 100%;
            max-width: 800px;
            text-align: center;
            animation: fadeInSlideUp 1s ease-out;
        }
        @keyframes fadeInSlideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        .signup-form-wrapper h2 {
            font-size: 32px;
            font-weight: 700;
            line-height: 1.4;
            margin-bottom: 15px;
            color: #1E293B;
        }

        .signup-form-wrapper .subtitle {
            color: #64748B;
            font-size: 16px;
            margin-bottom: 50px;
        }

        .form-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px 30px;
        }

        .form-group {
            text-align: left;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .form-group.full-width {
            grid-column: 1 / -1;
        }

        .form-group label {
            font-size: 14px;
            font-weight: 600;
            color: #1E293B;
        }

        .form-group input, .form-group select {
            width: 100%;
            background: #F8FAFC;
            border: 1px solid #E2E8F0;
            border-radius: 14px;
            padding: 16px 20px;
            font-size: 16px;
            color: #1E293B;
            font-family: 'Pretendard', sans-serif;
            transition: all 0.3s ease;
        }

        .form-group input:focus, .form-group select:focus {
            outline: none;
            border-color: var(--accent-color);
            background: #FFFFFF;
            box-shadow: 0 0 0 3px rgba(249, 115, 22, 0.1);
        }
        
        .form-group select {
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3E%3Cpath stroke='%231E293B' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='m6 8 4 4 4-4'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 1rem center;
            cursor: pointer;
        }

        .region-select-group {
            display: flex;
            gap: 10px;
        }

        .btn-submit {
            width: 100%;
            padding: 16px;
            border-radius: 12px;
            background: var(--accent-color);
            color: white;
            font-weight: 700;
            font-size: 16px;
            cursor: pointer;
            border: none;
            transition: all 0.3s;
            margin-top: 20px;
            grid-column: 1 / -1;
        }
        .btn-submit:hover { 
            transform: translateY(-3px);
            background: var(--accent-color-hover);
            box-shadow: 0 10px 25px rgba(249, 115, 22, 0.3);
        }

        .form-footer {
            margin-top: 30px;
            font-size: 14px;
            color: #64748B;
        }
        .form-footer a { color: #1E293B; text-decoration: none; font-weight: 500; transition: color 0.3s; }
        .form-footer a:hover { color: #64748B; }

    </style>
</head>
<body>

    <main class="signup-container">
        <div class="signup-form-wrapper">
            <h2>동네친구가 처음이신가요?</h2>
            <p class="subtitle">몇 가지 정보만 입력하고 새로운 친구들을 만나보세요.</p>
            
            <form id="signupForm">
                <div class="form-grid">
                    <div class="form-group">
                        <label for="name">이름</label>
                        <input type="text" id="name" name="name" placeholder="이름을 입력하세요" required>
                    </div>
                    <div class="form-group">
                        <label for="username">아이디</label>
                        <input type="text" id="username" name="username" placeholder="아이디를 입력하세요" required>
                    </div>
                    <div class="form-group">
                        <label for="pwd">비밀번호</label>
                        <input type="password" id="pwd" name="pwd" placeholder="비밀번호를 입력하세요" required>
                    </div>
                    <div class="form-group">
                        <label for="pwd-confirm">비밀번호 확인</label>
                        <input type="password" id="pwd-confirm" name="pwd-confirm" placeholder="비밀번호를 다시 입력하세요" required>
                    </div>
                    <div class="form-group">
                        <label for="birth">생년월일</label>
                        <input type="date" id="birth" name="birth" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="district">지역</label>
                        <div class="region-select-group">
							<select id="district" name="district" required>
							    <option value="" disabled selected>시/도 선택</option>
							    <option 
							        th:each="province : ${provinceList}" 
							        th:value="${province.provinceId}" 
							        th:text="${province.provinceName}">
							        </option>
							</select>
                            
                            <select id="region" name="regionId" required disabled>
                                <option value="" disabled selected>시/군/구 선택</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-group full-width">
                        <label for="address">상세주소</label>
                        <input type="text" id="address" name="address" placeholder="상세주소를 입력하세요" required>
                    </div>
                    <div class="form-group">
                        <label for="phone">전화번호</label>
                        <input type="tel" id="phone" name="phone" placeholder="전화번호를 입력하세요" required>
                    </div>
                    <div class="form-group">
                        <label for="email">이메일</label>
                        <input type="email" id="email" name="email" placeholder="이메일을 입력하세요" required>
                    </div>
                    <button type="button" class="btn-submit" onclick="signupProc()">회원가입 완료</button>
                </div>
            </form>

            <div class="form-footer">
                <p>이미 계정이 있으신가요? <a href="login">로그인하기</a></p>
            </div>
        </div>
    </main>

    <script th:inline="javascript">        
	    const districtSelect = document.getElementById('district');
	    const regionSelect = document.getElementById('region');
	    const regionList = /*[[${regionList}]]*/ null;
	    
        districtSelect.addEventListener('change', function() {
            // 선택된 시/도 이름(예: 서울특별시)을 가져옵니다. (value 대신 텍스트 사용)
            const selectedOption = this.options[this.selectedIndex];
            const selectedValue = selectedOption.value;
            const numericValue = parseInt(selectedValue, 10);
            
            // 시/군/구(regionSelect) 초기화
            regionSelect.innerHTML = '<option value="" disabled selected>시/군/구 선택</option>';

            for(var i=0; i<regionList.length; i++){
            	if(numericValue === regionList[i].provinceId){
            		const option = document.createElement('option');
            		option.value = numericValue;
            		option.textContent = regionList[i].regionName;
            		regionSelect.appendChild(option);
            	}
            }
            regionSelect.disabled = false;
        });
        
        const signupForm = document.getElementById('signupForm');
        signupForm.addEventListener('submit', function(event) {
                event.preventDefault();
                signupProc();
        });
        
        function signupProc(){
        	
        	//입력 필드 가져오기
            var name = document.getElementById('name');
            var username = document.getElementById('username');
            var pwd = document.getElementById('pwd');
            var pwd_confirm = document.getElementById('pwd-confirm');
            var birth = document.getElementById('birth');
            var district = document.getElementById('district');
            var region = document.getElementById('region');
            var address = document.getElementById('address');
            var phone = document.getElementById('phone');
            var email = document.getElementById('email');
            
			fetch("/insertSignup", {
			    method: "POST",
			    headers: {
			        "Content-Type": "application/json"
			    },
			    body: JSON.stringify({
			    	name: name.value.trim(),
			    	username: username.value.trim(),
			    	pwd: pwd.value.trim(),
			    	birth: birth.value.trim(),
			    	regionId: region.value.trim(),
			    	address: address.value.trim(),
			    	phone: phone.value.trim(),
			    	email: email.value.trim()
			    })
			})
			.then(response => response.json())
			.then(function(data){
				if(data.status === 1){
					location.replace("login");
				}
			})
			.catch(error => console.error("Error:", error));
        }
        
        //유효성 검사
        function isValid(name, username, pwd, pwd_confirm, birth, district, region, address, phone, email) {
			var isValid = true;

/*           
            //유효성 검사
			!/^[가-힣]+$/.test(name) 한글만 입력 가능
			!/^[a-zA-Z0-9]{6,15}$/.test(username) 영어와 숫자로 6~15자리
			!/^(?=.*[a-zA-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,20}$/.test(pwd) 영어, 숫자, 특수문자를 포함한 8~20자리
			!/^\d{6}$/.test(birth) 숫자 6자리
			!/^\d{11}$/.test(phone) 숫자 11자리
			!/^([a-zA-Z][a-zA-Z0-9]{4,16})@([a-z0-9]+\.)[a-z]{2,4}$/.test(email) 유효한 이메일 주소를 입력
*/
            return isValid;
        }

    </script>

</body>
</html>