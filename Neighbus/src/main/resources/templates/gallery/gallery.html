<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta name="_csrf" th:content="${_csrf.token}" />
	<meta name="_csrf_header" th:content="${_csrf.headerName}" />
	<title>ê°¤ëŸ¬ë¦¬ - ë™ë„¤ì¹œêµ¬</title>
	<link href="https://cdn.jsdelivr.net/gh/sunn-us/SUIT/fonts/static/woff2/SUIT.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
	<link rel="stylesheet" href="/css/navibar.css">
	<link rel="stylesheet" href="/css/bottom-navbar.css">

	<style>
	    /* [1. ì»¬ëŸ¬ ë° ë³€ìˆ˜ ì„¤ì •] */
	    :root {
	        --primary: #A67C52;
	        --primary-dark: #8D6E63;
	        --primary-light: #C9A88A;
	        --bg-ivory: #FFF8F0;
	        --bg-warm: #FFF5EB;
	        --bg-cream: #FAF0E6;
	        --card-bg: #FFFBF7;
	        --text-primary: #5D4037;
	        --text-secondary: #8D6E63;
	        --text-light: #A1887F;
	        --border-color: #E8D7C3;
	        --shadow-color: rgba(166, 124, 82, 0.15);
	        --shadow-hover: rgba(166, 124, 82, 0.25);
	        --white: #FFFFFF;
	    }

	    /* [2. ê¸°ë³¸ ì´ˆê¸°í™”] */
	    html,
	    body {
	        font-family: 'SUIT', -apple-system, BlinkMacSystemFont, system-ui, sans-serif;
	        color: var(--text-primary);
	        background: var(--bg-ivory);
	        overflow-x: hidden;
	        position: relative;
	        line-height: 1.5;
	    }

	    /* ğŸš€ ìƒë‹¨ ë„¤ë¹„ë°” ìˆ˜ì§ ì •ë ¬ ì™„ì „ ì •ë³µ (ìˆ˜ì • í•µì‹¬) */
	    /* 1.5ë°° ì¤„ê°„ê²©ì´ ë„¤ë¹„ë°”ë¥¼ ë‘ê»ê²Œ ë§Œë“¤ì§€ ì•Šë„ë¡ ì´ˆê¸°í™” */
	    .navbar, 
	    .navbar-brand, 
	    .nav-link, 
	    .navbar-text,
	    .navbar-nav,
	    .navbar-toggler {
	        line-height: 1.2 !important; /* ì¤„ê°„ê²© ì¶•ì†Œ */
	        display: flex !important;
	        align-items: center !important; /* ìˆ˜ì§ ì¤‘ì•™ ì •ë ¬ ê°•ì œ */
	        height: auto !important;
	    }

	    /* ë„¤ë¹„ë°” ë‚´ë¶€ í…ìŠ¤íŠ¸ ë° ë¡œê³  ìœ„ì¹˜ ë¯¸ì„¸ ì¡°ì • */
	    .navbar-brand, .nav-link {
	        padding-top: 0 !important;
	        padding-bottom: 0 !important;
	        margin-top: auto !important;
	        margin-bottom: auto !important;
	    }

	    /* [3. ë ˆì´ì•„ì›ƒ ë˜í¼] */
	    .nb-bottom-nav {
	        position: fixed !important;
	        bottom: 0 !important;
	        left: 0 !important;
	        right: 0 !important;
	        z-index: 9999 !important;
	    }

	    .main-wrapper {
	        padding-top: 0;
	        min-height: 100vh;
	        background: linear-gradient(165deg, var(--bg-ivory) 0%, var(--bg-warm) 50%, var(--bg-cream) 100%);
	        position: relative;
	    }

	    @media (max-width: 991px) {
	        .main-wrapper {
	            padding-bottom: calc(80px + env(safe-area-inset-bottom));
	        }
	    }

	    /* ë°°ê²½ ì¥ì‹ */
	    .main-wrapper::before {
	        content: '';
	        position: absolute;
	        top: -10%;
	        right: -5%;
	        width: 600px;
	        height: 600px;
	        background: radial-gradient(circle, rgba(166, 124, 82, 0.04) 0%, transparent 70%);
	        border-radius: 50%;
	        animation: float 20s ease-in-out infinite;
	        z-index: 0;
	        pointer-events: none;
	    }

	    @keyframes float {
	        0%, 100% { transform: translate(0, 0) scale(1); }
	        50% { transform: translate(20px, -20px) scale(1.05); }
	    }

	    .container { position: relative; z-index: 1; }

	    /* [4. í˜ì´ì§€ í—¤ë”] */
	    .page-header {
	        text-align: center;
	        margin-bottom: 3rem;
	        animation: fadeInSlideUp 1s ease-out;
	        padding-top: 3rem;
	    }

	    @keyframes fadeInSlideUp {
	        from { opacity: 0; transform: translateY(30px); }
	        to { opacity: 1; transform: translateY(0); }
	    }

	    .page-title {
	        font-size: 3rem;
	        font-weight: 800;
	        color: var(--text-primary);
	        margin-bottom: 0.5rem;
	        letter-spacing: -0.03em;
	        line-height: 1.2;
	    }

	    .page-subtitle {
	        font-size: 1.1rem;
	        color: var(--text-secondary);
	        font-weight: 500;
	    }

	    /* [5. í•„í„° ì„¹ì…˜] */
	    .filter-section {
	        margin-bottom: 3rem;
	        animation: fadeInSlideUp 1s ease-out 0.2s both;
	    }

	    .filter-box {
	        background: var(--card-bg);
	        border: 1px solid var(--border-color);
	        border-radius: 1rem;
	        padding: 1.5rem;
	        box-shadow: 0 4px 20px var(--shadow-color);
	    }

	    .filter-box .club-select,
	    .filter-box .form-control,
	    .filter-box .btn-search { height: 48px; }

	    .btn-search {
	        background: var(--primary);
	        color: var(--white);
	        border: none;
	        font-weight: 600;
	        padding: 0 2rem;
	        border-radius: 10px;
	    }

	    .btn-write {
	        background: var(--primary);
	        color: var(--white);
	        font-weight: 600;
	        padding: 0.6rem 1.5rem;
	        border-radius: 10px;
	        text-decoration: none;
	        display: inline-flex;
	        align-items: center;
	    }

	    /* [6. ê°¤ëŸ¬ë¦¬ ê·¸ë¦¬ë“œ] */
	    .gallery-grid {
	        display: grid;
	        grid-template-columns: repeat(3, 1fr);
	        gap: 2rem;
	        margin-bottom: 3rem;
	    }

	    .gallery-card {
	        background: var(--card-bg);
	        border-radius: 20px;
	        overflow: hidden;
	        transition: transform 0.4s ease;
	        text-decoration: none;
	        display: flex;
	        flex-direction: column;
	        height: 100%;
	        box-shadow: 0 2px 8px var(--shadow-color);
	    }

	    .gallery-card:hover { transform: translateY(-10px); }

	    .card-image-wrapper {
	        position: relative;
	        height: 250px;
	        overflow: hidden;
	    }

	    .card-image { width: 100%; height: 100%; object-fit: cover; }

	    .card-body { padding: 1.5rem; flex-grow: 1; display: flex; flex-direction: column; }
	    .card-title { font-size: 1.25rem; font-weight: 700; margin-bottom: 0.8rem; }
	    .card-description { font-size: 0.95rem; color: var(--text-secondary); line-height: 1.6; margin-bottom: 1.2rem; }

	    /* [7. ëª¨ë°”ì¼ 3ì—´ ë ˆì´ì•„ì›ƒ (ë°˜ì‘í˜•)] */
	    @media (max-width: 991px) {
	        .gallery-grid { grid-template-columns: repeat(2, 1fr); gap: 1.5rem; }
	    }

	    @media (max-width: 768px) {
	        .gallery-grid { grid-template-columns: repeat(3, 1fr); gap: 0.6rem; }
	        .card-image-wrapper { height: 110px; }
	        .card-body { padding: 0.6rem; }
	        .card-title { font-size: 0.8rem; -webkit-line-clamp: 1; display: -webkit-box; -webkit-box-orient: vertical; overflow: hidden; }
	        .card-description { display: none; }
	    }

	    /* [8. ê¸°íƒ€ ìš”ì†Œ] */
	    .club-select {
	        appearance: none;
	        padding: 0 2.5rem 0 1rem;
	        background-color: var(--white);
	        border: 1px solid var(--border-color);
	        border-radius: 10px;
	        width: 100%;
	        background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3E%3Cpath stroke='%238D6E63' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='m6 8 4 4 4-4'/%3E%3C/svg%3E");
	        background-repeat: no-repeat;
	        background-position: right 12px center;
	        background-size: 18px;
	    }

	    .pagination .page-link {
	        color: var(--text-secondary);
	        border: 1px solid var(--border-color);
	        margin: 0 4px;
	        border-radius: 8px;
	        width: 40px; height: 40px;
	        display: flex; align-items: center; justify-content: center;
	    }
	    .page-item.active .page-link { background-color: var(--primary); color: var(--white); }
	</style>

</head>

<body>
	<div th:replace="~{include/navibar :: header-nav}"></div>

	<div class="main-wrapper">
		<div class="container">
			<div class="page-header">
				<h1 class="page-title">ê°¤ëŸ¬ë¦¬</h1>
				<p class="page-subtitle">ìš°ë¦¬ ë™ë„¤ ì‚¬ì§„ìœ¼ë¡œ ê³µìœ í•˜ëŠ” ì´ì•¼ê¸°</p>
			</div>

			<div class="filter-section">
				<!-- ê¸€ì“°ê¸° ë²„íŠ¼ -->
				<div class="d-flex justify-content-end mb-3">
					<a href="/gallery/write" class="btn btn-write d-flex align-items-center">
						<i class="bi bi-pencil-square me-2"></i>ê¸€ì“°ê¸°
					</a>
				</div>

				<!-- í•„í„° ë°•ìŠ¤ (1ì¤„ë¡œ ì••ì¶•) -->
				<form th:action="@{/gallery}" method="get" id="filterForm" onSubmit="search(event)">
					<div class="filter-box rounded-4">
						<div class="row g-3 align-items-center">
							<!-- ë™ì•„ë¦¬ ì„ íƒ -->
							<div class="col-lg-3 col-md-4 col-12">
								<select id="clubSelect" class="club-select" onChange="search(event)">
									<option value="0">ì „ì²´ ë™ì•„ë¦¬</option>
									<th:block th:each="myClub : ${myClubList}">
										<option th:value="${myClub.id}" th:text="${myClub.clubName}"
											th:selected="${myClub.id == galleryDTO.clubId}"></option>
									</th:block>
								</select>
							</div>

							<!-- ê²€ìƒ‰ì°½ -->
							<div class="col-lg-7 col-md-6 col-12">
								<div class="input-group">
									<span class="input-group-text">
										<i class="bi bi-search"></i>
									</span>
									<input type="text" id="keywordInput" name="keyword" th:value="${keyword}"
										placeholder="ì œëª©, ì‘ì„±ìë¡œ ê²€ìƒ‰í•´ë³´ì„¸ìš”" class="form-control">
								</div>
							</div>

							<!-- ê²€ìƒ‰ ë²„íŠ¼ -->
							<div class="col-lg-2 col-md-2 col-12">
								<button type="submit" class="btn btn-search w-100">
									ê²€ìƒ‰
								</button>
							</div>
						</div>
					</div>
				</form>
			</div>

			<div class="gallery-grid">
				<a class="gallery-card" th:each="gallery : ${galleryMapList}"
					th:href="@{/gallery/detail/{id}(id=${gallery.ID})}">

					<div class="card-image-wrapper">
						<img th:if="${gallery.IMAGES != null and gallery.IMAGES.size() > 0}"
							th:src="${gallery.IMAGES[0].IMG}" alt="ê°¤ëŸ¬ë¦¬ ì´ë¯¸ì§€" class="card-image">
						<img th:unless="${gallery.IMAGES != null and gallery.IMAGES.size() > 0}" src="/img/no-image.png"
							alt="ì´ë¯¸ì§€ ì—†ìŒ" class="card-image" style="opacity: 0.5;">

						<div class="author-badge">
							<i class="bi bi-person-fill me-1"></i>
							<span th:utext="${gallery.WRITER}">ì‘ì„±ì</span>
						</div>
					</div>

					<div class="card-body">
						<h5 class="card-title" th:utext="${gallery.TITLE}">ì œëª©</h5>

						<p class="card-description" th:utext="${#strings.replace(gallery.CONTENT, '<br>', ' ')}">
							ë‚´ìš©
						</p>

						<div class="card-meta">
							<span><i class="bi bi-calendar-event me-1"></i> <span
									th:text="${#temporals.format(gallery.CREATED_AT, 'yyyy.MM.dd')}"></span></span>
						</div>
					</div>
				</a>
			</div>

			<nav th:if="${pagingMap != null and pagingMap.searchCnt > 0}" aria-label="Page navigation">
				<ul class="pagination justify-content-center">
					<li class="page-item" th:classappend="${pagingMap.selectPageNo == 1} ? 'disabled'">
						<a class="page-link"
							th:href="@{/gallery(selectPageNo=${pagingMap.selectPageNo - 1}, keyword=${keyword}, clubId=${galleryDTO.clubId})}"
							aria-label="Previous">
							<i class="bi bi-chevron-left"></i>
						</a>
					</li>

					<li class="page-item"
						th:each="page : ${#numbers.sequence(pagingMap.beginPageNo, pagingMap.endPageNo)}"
						th:classappend="${page == pagingMap.selectPageNo} ? 'active'">
						<a class="page-link"
							th:href="@{/gallery(selectPageNo=${page}, keyword=${keyword}, clubId=${galleryDTO.clubId})}"
							th:text="${page}">1</a>
					</li>

					<li class="page-item"
						th:classappend="${pagingMap.selectPageNo == pagingMap.endPageNo} ? 'disabled'">
						<a class="page-link"
							th:href="@{/gallery(selectPageNo=${pagingMap.selectPageNo + 1}, keyword=${keyword}, clubId=${galleryDTO.clubId})}"
							aria-label="Next">
							<i class="bi bi-chevron-right"></i>
						</a>
					</li>
				</ul>
			</nav>
		</div>
	</div>

	<form id="clubSelectForm">
		<input type="hidden" name="clubId" th:value="${galleryDTO.clubId}">
		<input type="hidden" name="selectPageNo" th:value="${pagingMap.selectPageNo}">
		<input type="hidden" name="keyword" th:value="${keyword}">
	</form>

	<script>
		function search(e) {
			e.preventDefault();
			const formObj = document.getElementById('clubSelectForm');
			const clubSelect = document.getElementById('clubSelect');

			if (clubSelect) {
				formObj.querySelector('input[name="clubId"]').value = clubSelect.value;
			}

			const keywordInput = document.getElementById('keywordInput');
			if (keywordInput) {
				formObj.querySelector('input[name="keyword"]').value = keywordInput.value.trim();
			}

			formObj.querySelector('input[name="selectPageNo"]').value = 1;
			formObj.action = "/gallery";
			formObj.submit();
		}
	</script>
	<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
	<div th:replace="~{include/bottom-navbar :: bottom-nav}"></div>
</body>

</html>